# 对数据系统的思考

传统上我们将数据库、队列、缓存等看做不同种类的工具。都是在某种场景下存储数据，数据库和消息队列在这点上看起来很像，但是他们有着不同的访问方
式，这意味着他们需要具备不同的性能特性，也因此要具备不同的实现。

我们简单粗暴地把这些都归纳为*数据系统*，用单一的眼光去看待他们是不合适的。

近年来出现了很多数据存储和数据处理工具。他们对不同的应用场景进行过优化，也并不能简洁地归入传统的分类中[[1]](../../README.md#b1_c1_1)。
例如，有的数据存储工具也被当成消息队列来使用（Redis），也有消息队列能具备像数据库一般的数据持久化保证（Apache Kafka）。传统分类间的边界
正变得越来越模糊。

另一方面，越来越多的应用正在变得复杂，单一工具无法满足他们的数据处理和数据存储的需求。取而代之的，应用的能力被拆解成许多的任务，每个任务都
能使用某个工具高效地执行，而应用的代码就会在更上一层把这些工具串连起来。

例如，假设你从主数据库中分化出来一层缓存（使用Memcached或者类似的工具），或者一套全文检索服务（例如Elasticsearch或者Solr），那你通常都
需要在应用代码中实现一套逻辑去保证缓存及索引和主数据库中保持一致。**图1-1**概括的描绘了这套系统的形态，而在随后的章节中我们会逐渐深入细节。



*图1-1. 多组件数据系统的一种可能的架构* 

这里将多个工具组成服务时，而客户端很可能看不见，也不用关心服务接口和API的实现细节。从本质上来说，你构建了这样一个全新的，有着特定业务目标
的数据系统，而系统的基础是那些小型的、泛用性的组件。这套复合系统可能会特别关注一些特性，比如：客户端希望看到一致的结果，因此数据写入时，缓
存要被正确的废除或者更新。从这点上来说，你不仅仅关注应用的功能开发，更需要关注数据系统的整体设计。

很多问题会在设计数据系统和服务的时候凸显出来：
- 怎样在内部组件产生了一些错误时，仍然保证数据的完整和正确？
- 怎样在系统中某些部分降级的时候，仍然确保对客户端提供服务的性能？
- 怎样面对不断增长的业务压力？
- 该怎样提供一个优雅的API？

现实中，很多要素会影响数据系统的设计，例如开发者的技能和经验，遗留系统的依赖和兼容，交付的时间窗口，业务和公司的风险目标，政策风险（学过
CFA的老婆如是说）等。这些因素视应用场景而定。

这本书里，像大多数软件系统关心的那样，我们着重考虑以下三个方面：

*可靠性*

> 即使碰到了*灾害*（软、硬件失效，甚至是人为错误），系统也能够*正确的*（以合理的性能提供正确的功能）工作。
> 参考"[可靠性](2_reliability.md)"。

*可扩展性*

> 有合理的方式去应对系统的增长（数据量，traffic……嗯不翻了，复杂度）。
> 参考"[可扩展性](3_scalability.md)"。

*可维护性*

> 随着时间的推移，开发系统的人员会变更，他们会维护现有的功能、又或者开发新的功能，他们应该有能力在这个系统上高效的工作。
> 参考"[可维护性](4_maintainability.md)"。

这些词经常被滥用。

为了能够系统性的思考，我们将用接下来的几章来讨论怎么思考可靠性、可扩展性和可维护性。随后，在接下来的几章里，我们将会研究多种技术、架构和
算法，从而实现这些目标。
